{
  "_fv": 47,
  "_type": "procedure",
  "definition": {
    "procedurexml": "<xml xmlns=\"https://developers.google.com/blockly/xml\"><block type=\"event_trigger\" deletable=\"false\" x=\"40\" y=\"40\"><field name=\"trigger\">no_ext_trigger</field><next><block type=\"controls_if\"><mutation elseif=\"1\"></mutation><value name=\"IF0\"><block type=\"logic_binary_ops\"><field name=\"OP\">AND</field><value name=\"A\"><block type=\"compare_mcitems\"><value name=\"a\"><block type=\"entity_iteminhand\"><value name=\"entity\"><block type=\"entity_from_deps\"></block></value></block></value><value name=\"b\"><block type=\"mcitem_all\"><field name=\"value\">CUSTOM:ShaYingcrc</field></block></value></block></value><value name=\"B\"><block type=\"java_code_get\"><field name=\"CODE\">((ShaYingcrcItem)(entity instanceof LivingEntity _livEnt ? _livEnt.getMainHandItem() : ItemStack.EMPTY).getItem()).canFire()&amp;#10;</field></block></value></block></value><statement name=\"DO0\"><block type=\"java_code\"><field name=\"CODE\">if(entity instanceof Player player &amp;&amp;world instanceof ServerLevel serverLevel){&amp;#10;\t\t\t\t\t((ShaYingcrcItem) (entity instanceof LivingEntity _livEnt ? _livEnt.getMainHandItem() : ItemStack.EMPTY).getItem()).fireAnim(serverLevel, player,player.getMainHandItem());&amp;#10;\t\t\t\t}</field><next><block type=\"controls_if\"><value name=\"IF0\"><block type=\"compare_mcitems\"><value name=\"a\"><block type=\"entity_iteminhand\"><value name=\"entity\"><block type=\"entity_from_deps\"></block></value></block></value><value name=\"b\"><block type=\"mcitem_all\"><field name=\"value\">CUSTOM:ShaYingcrc</field></block></value></block></value><statement name=\"DO0\"><block type=\"item_cooldown_for\"><value name=\"entity\"><block type=\"entity_from_deps\"></block></value><value name=\"item\"><block type=\"entity_iteminhand\"><value name=\"entity\"><block type=\"entity_from_deps\"></block></value></block></value><value name=\"ticks\"><block type=\"math_number\"><field name=\"NUM\">8</field></block></value><next><block type=\"java_code\"><field name=\"CODE\">if (world instanceof ServerLevel projectileLevel) {&amp;#10;\t\t\t\t\tProjectile _entityToSpawn = new Object() {&amp;#10;\t\t\t\t\t\tpublic Projectile getArrow(Level level, Entity shooter, float damage, int knockback, byte piercing) {&amp;#10;\t\t\t\t\t\t\tAbstractArrow entityToSpawn = new DesertEagleBulletEntity(SimpledeserteagleModEntities.DESERT_EAGLE_BULLET.get(), level);&amp;#10;\t\t\t\t\t\t\tentityToSpawn.setOwner(shooter);&amp;#10;\t\t\t\t\t\t\tentityToSpawn.setNoGravity(true);&amp;#10;\t\t\t\t\t\t\tentityToSpawn.setBaseDamage(damage);&amp;#10;\t\t\t\t\t\t\tentityToSpawn.setKnockback(knockback);&amp;#10;\t\t\t\t\t\t\tentityToSpawn.setSilent(true);&amp;#10;\t\t\t\t\t\t\tentityToSpawn.setPierceLevel(piercing);&amp;#10;\t\t\t\t\t\t\treturn entityToSpawn;&amp;#10;\t\t\t\t\t\t}&amp;#10;\t\t\t\t\t}.getArrow(projectileLevel, entity, (float)0.5, 1, (byte)5);&amp;#10;\t\t\t\t\t_entityToSpawn.setPos(x + 0.3, entity.getEyeY() - 0.2, z + 0.3);&amp;#10;\t\t\t\t\t_entityToSpawn.shoot(entity.getViewVector(1).x, entity.getViewVector(1).y, entity.getViewVector(1).z, 15, 0);&amp;#10;\t\t\t\t\tprojectileLevel.addFreshEntity(_entityToSpawn);&amp;#10;\t\t\t\t\t((ShaYingcrcItem)(entity instanceof LivingEntity _livEnt ? _livEnt.getMainHandItem() : ItemStack.EMPTY).getItem()).useMagazine();&amp;#10;\t\t\t\t}</field><next><block type=\"play_sound\"><field name=\"sound\">CUSTOM:deserteagelcrcfire</field><field name=\"soundcategory\">player</field><value name=\"x\"><block type=\"coord_x\"></block></value><value name=\"y\"><block type=\"coord_y\"></block></value><value name=\"z\"><block type=\"coord_z\"></block></value><value name=\"level\"><block type=\"math_number\"><field name=\"NUM\">1</field></block></value><value name=\"pitch\"><block type=\"math_number\"><field name=\"NUM\">1</field></block></value><next><block type=\"java_code\"><field name=\"CODE\">double[] recoilTimer = {0}; // 后坐力计时器&amp;#10;\t\t\tdouble totalTime = 100;&amp;#10;\t\t\tint sleepTime = 2;&amp;#10;\t\t\tdouble recoilDuration = totalTime / sleepTime; // 后坐力持续时间&amp;#10;\t\t\tfloat speed = (float) ((Math.random() * 2) - 1) / 10;&amp;#10;\t\t\t// 使用匿名内部类实现 Runnable 接口&amp;#10;\t\t\tRunnable recoilRunnable = () -&gt; {&amp;#10;\t\t\t\twhile (recoilTimer[0] &lt; recoilDuration) {&amp;#10;\t\t\t\t\t// 逐渐调整玩家的视角&amp;#10;\t\t\t\t\tfloat newPitch = entity.getXRot() - (float) 0.2;//实时获取，以防鼠标冲突&amp;#10;\t\t\t\t\tfloat newYaw = entity.getYRot() - speed;&amp;#10;\t\t\t\t\tentity.setYRot(newYaw);&amp;#10;\t\t\t\t\tentity.setXRot(newPitch);&amp;#10;\t\t\t\t\tentity.yRotO = entity.getYRot();&amp;#10;\t\t\t\t\tentity.xRotO = entity.getXRot();&amp;#10;\t\t\t\t\trecoilTimer[0]++; // 计时器递增&amp;#10;\t\t\t\t\ttry {&amp;#10;\t\t\t\t\t\tThread.sleep(sleepTime); // 每次暂停20毫秒，模拟玩家的视角变化&amp;#10;\t\t\t\t\t} catch (InterruptedException e) {&amp;#10;\t\t\t\t\t\te.printStackTrace();&amp;#10;\t\t\t\t\t}&amp;#10;\t\t\t\t}&amp;#10;\t\t\t\twhile (recoilTimer[0] &gt; 0) {&amp;#10;\t\t\t\t\tfloat newPitch = entity.getXRot() + (float) 0.2;&amp;#10;\t\t\t\t\tfloat newYaw = entity.getYRot() + speed;&amp;#10;\t\t\t\t\tentity.setXRot(newPitch);&amp;#10;\t\t\t\t\tentity.setYRot(newYaw);&amp;#10;\t\t\t\t\tentity.xRotO = entity.getXRot();&amp;#10;\t\t\t\t\tentity.yRotO = entity.getYRot();&amp;#10;\t\t\t\t\trecoilTimer[0]--; // 计时器递增&amp;#10;\t\t\t\t\ttry {&amp;#10;\t\t\t\t\t\tThread.sleep(sleepTime); // 每次暂停20毫秒，模拟玩家的视角变化&amp;#10;\t\t\t\t\t} catch (InterruptedException e) {&amp;#10;\t\t\t\t\t\te.printStackTrace();&amp;#10;\t\t\t\t\t}&amp;#10;\t\t\t\t}&amp;#10;\t\t\t};&amp;#10;\t\t\tThread recoilThread = new Thread(recoilRunnable); // 创建线程对象&amp;#10;\t\t\trecoilThread.start(); // 启动线程</field><next><block type=\"java_code\"><field name=\"CODE\">if (world instanceof ServerLevel _level)&amp;#10;\t\t\t\t\t_level.getServer().getCommands().performPrefixedCommand(new CommandSourceStack(CommandSource.NULL, new Vec3(x, y, z), Vec2.ZERO, _level, 4, \"\", Component.literal(\"\"), _level.getServer(), null).withSuppressedOutput(), &amp;#10;\t\t\t\t\t\t\t\"title @p actionbar \\\"\"+((ShaYingcrcItem) (entity instanceof LivingEntity _livEnt ? _livEnt.getMainHandItem() : ItemStack.EMPTY).getItem()).getMagazine()+\"/7\"+\"\\\"\");</field></block></next></block></next></block></next></block></next></block></statement></block></next></block></statement><value name=\"IF1\"><block type=\"logic_binary_ops\"><field name=\"OP\">AND</field><value name=\"A\"><block type=\"compare_mcitems\"><value name=\"a\"><block type=\"entity_iteminhand\"><value name=\"entity\"><block type=\"entity_from_deps\"></block></value></block></value><value name=\"b\"><block type=\"mcitem_all\"><field name=\"value\">CUSTOM:ShaYingcrc</field></block></value></block></value><value name=\"B\"><block type=\"logic_negate\"><value name=\"BOOL\"><block type=\"java_code_get\"><field name=\"CODE\">((ShaYingcrcItem)(entity instanceof LivingEntity _livEnt ? _livEnt.getMainHandItem() : ItemStack.EMPTY).getItem()).canFire()&amp;#10;</field></block></value></block></value></block></value><statement name=\"DO1\"><block type=\"java_code\"><field name=\"CODE\">if (world instanceof ServerLevel _level)&amp;#10;\t\t\t\t_level.getServer().getCommands().performPrefixedCommand(new CommandSourceStack(CommandSource.NULL, new Vec3(x, y, z), Vec2.ZERO, _level, 4, \"\", Component.literal(\"\"), _level.getServer(), null).withSuppressedOutput(),&amp;#10;\t\t\t\t\t\t\"title @p actionbar \\\"Please press 'R' to reload.\\\"\");</field></block></statement></block></next></block><block type=\"item_animation\" x=\"1047\" y=\"424\"><field name=\"name\">CUSTOM:ShaYingcrc</field><value name=\"item\"><block type=\"entity_iteminhand\"><value name=\"entity\"><block type=\"entity_from_deps\"></block></value></block></value><value name=\"animation\"><block type=\"text\"><field name=\"TEXT\">animation.DesertEagelCRC.Fire</field></block></value></block></xml>"
  }
}